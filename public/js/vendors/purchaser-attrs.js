/*! For license information please see purchaser-attrs.js.LICENSE.txt */
"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[91],{2421:(e,t,n)=>{n.r(t),n.d(t,{default:()=>q});var r=n(7456),o={class:"row"},i={class:"col-12 col-md-12 col-lg-8 order-2 order-md-1"},a={class:"card card-primary card-outline card-tabs"},s={class:"card-body"},l={class:"tab-content",id:"custom-tabs-three-tabContent"},c={class:"row invoice-info"},u={class:"col-sm-4 invoice-col"},d={class:"form-group"},p=["value"],f=["onUpdate:modelValue","index"],h=["value"],m=["disabled"],b={class:"col-12 col-md-12 col-lg-4 order-1 order-md-2"},g={class:"card card-primary card-outline card-tabs"},v={class:"card-body"},y=["disabled"],x={class:"card card-primary card-outline card-tabs"},A={class:"card-body"};var w=n(3899),E=n(9404);function k(e){return k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},k(e)}function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){N(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function N(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=k(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=k(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==k(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function j(){j=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function l(e,t,n,r){return Object.defineProperty(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r})}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function c(t,n,r,o){var i=n&&n.prototype instanceof p?n:p,a=Object.create(i.prototype);return l(a,"_invoke",function(t,n,r){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:e,done:!0}}for(r.method=i,r.arg=a;;){var s=r.delegate;if(s){var l=A(s,r);if(l){if(l===d)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(1===o)throw o=4,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=3;var c=u(t,n,r);if("normal"===c.type){if(o=r.done?4:2,c.arg===d)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(o=4,r.method="throw",r.arg=c.arg)}}}(t,r,new _(o||[])),!0),a}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=c;var d={};function p(){}function f(){}function h(){}var m={};l(m,i,(function(){return this}));var b=Object.getPrototypeOf,g=b&&b(b(C([])));g&&g!==n&&r.call(g,i)&&(m=g);var v=h.prototype=p.prototype=Object.create(m);function y(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function x(e,t){function n(o,i,a,s){var l=u(e[o],e,i);if("throw"!==l.type){var c=l.arg,d=c.value;return d&&"object"==k(d)&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(d).then((function(e){c.value=e,a(c)}),(function(e){return n("throw",e,a,s)}))}s(l.arg)}var o;l(this,"_invoke",(function(e,r){function i(){return new t((function(t,o){n(e,r,t,o)}))}return o=o?o.then(i,i):i()}),!0)}function A(t,n){var r=n.method,o=t.i[r];if(o===e)return n.delegate=null,"throw"===r&&t.i.return&&(n.method="return",n.arg=e,A(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var i=u(o,t.i,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,d;var a=i.arg;return a?a.done?(n[t.r]=a.value,n.next=t.n,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,d):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,d)}function w(e){this.tryEntries.push(e)}function E(t){var n=t[4]||{};n.type="normal",n.arg=e,t[4]=n}function _(e){this.tryEntries=[[-1]],e.forEach(w,this),this.reset(!0)}function C(t){if(null!=t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw new TypeError(k(t)+" is not iterable")}return f.prototype=h,l(v,"constructor",h),l(h,"constructor",f),f.displayName=l(h,s,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,h):(e.__proto__=h,l(e,s,"GeneratorFunction")),e.prototype=Object.create(v),e},t.awrap=function(e){return{__await:e}},y(x.prototype),l(x.prototype,a,(function(){return this})),t.AsyncIterator=x,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new x(c(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},y(v),l(v,s,"Generator"),l(v,i,(function(){return this})),l(v,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}},t.values=C,_.prototype={constructor:_,reset:function(t){if(this.prev=this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(E),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0][4];if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(e){a.type="throw",a.arg=t,n.next=e}for(var o=n.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,l=i[1],c=i[2];if(-1===i[0])return r("end"),!1;if(!l&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<l)return this.method="next",this.arg=e,r(l),!0;if(s<c)return r(c),!1}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r[0]>-1&&r[0]<=this.prev&&this.prev<r[2]){var o=r;break}}o&&("break"===e||"continue"===e)&&o[0]<=t&&t<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o[2],d):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[2]===e)return this.complete(n[4],n[3]),E(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[0]===e){var r=n[4];if("throw"===r.type){var o=r.arg;E(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={i:C(t),r:n,n:r},"next"===this.method&&(this.arg=e),d}},t}function B(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,o)}function S(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){B(i,r,o,a,s,"next",e)}function s(e){B(i,r,o,a,s,"throw",e)}a(void 0)}))}}const V={props:["additional","model","url","setting","user","name"],data:function(){return{selected:null,main:[],attributes:[{selected:"",res:[]}]}},setup:function(e){return{v$:(0,E.Ay)(),m:(0,r.reactive)(e.model)}},created:function(){this.main=this.additional.categories},mounted:function(){console.log("m",this.m)},validations:function(){return{m:{special_attributes:{}}}},computed:{},methods:{exit:function(){return location.href=this.setting.url.request.exit.replace("new",this.model.id)},json:function(e){return JSON.stringify(e)},fromJson:function(e){return JSON.parse(e)},category:function(){if(event.target.value){var e=this.fromJson(event.target.value);this.attributes=[{selected:"",res:e.category_attributes}],console.log("res",e)}},redirect:function(e){if(e.target.value){var t=this.fromJson(e.target.value),n=Number(e.target.getAttribute("index"))+1,r=(Number(e.target.getAttribute("index")),t.nested);this.attributes.splice(n,this.attributes.length),r.length&&(this.attributes[n]={selected:"",res:r}),this.selected=t}},addCategory:function(){var e=this;try{this.m.special_attributes.find((function(t){return t.json.uuid==e.selected.uuid}))?this.$toast.error("მყიდველი უკვე სარგებლობს მოცემული შემოთავაზებით!",{position:"top-right",duration:7e3}):this.selected.category_type?this.$toast.error("ატრიბუტი განეკუთნება კატეგორიის ტიპს!",{position:"top-right",duration:7e3}):(this.selected.isSpecial=!0,this.m.special_attributes.splice(0,0,{purchaser_id:this.model.id,category_attribute_id:this.selected.id,json:this.selected}))}catch(e){this.$toast.error("შეარჩიეთ ატრიბუტი!",{position:"top-right",duration:7e3})}},removeRequest:function(e,t,n){var r=this;if(!e)return n();document.querySelector("form#render").getAttribute("action");var o=document.querySelector('meta[name="csrf-token"').getAttribute("content");return this.$http.delete(t.url.request.destroy.replace("__delete__",e),{id:e},{"Content-Type":"application/json","X-CSRF-TOKEN":o}).then(function(){var e=S(j().mark((function e(t){return j().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:1==t.data.success?n():t.data.errs.map((function(e){return r.$toast.error(e,{position:"top-right",duration:7e3})}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){r.$toast.error(e.response.statusText,{position:"top-right",duration:7e3})}))},try_remove:function(e){var t=this;this.removeRequest(e.id||null,this.setting,(function(){t.m.special_attributes.splice(t.m.special_attributes.findIndex((function(t){return t.category_attribute_id==e.category_attribute_id})),1),Swal.fire("წაშლა!","წაშლა შესრრულდა წარმატებით.","success")}))},send:function(e){var t=this;e.preventDefault();var n=document.querySelector("form#render").getAttribute("action"),r=document.querySelector('meta[name="csrf-token"').getAttribute("content"),o=w.A.exit(this.m.special_attributes.map((function(e){return C(C({},e),{},{json:JSON.stringify(e.json)})})));this.$http.post(n,o,{"Content-Type":"application/json","X-CSRF-TOKEN":r}).then(function(){var e=S(j().mark((function e(n){return j().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:w.A.useSwall(n).then((function(e){n.data.success||n.data.errs&&n.data.errs.map((function(e){return t.$toast.error(e,{position:"top-right",duration:7e3})})),e.value&&window.location.replace(t.setting.url.request.exit.replace("new",t.model.id))}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){t.$toast.error(e.response.statusText,{position:"top-right",duration:7e3})}))}}};var O=n(5072),T=n.n(O),$=n(4937),P={insert:"head",singleton:!1};T()($.A,P);$.A.locals;const q=(0,n(6262).A)(V,[["render",function(e,t,n,w,E,k){var _=(0,r.resolveComponent)("purchaser-single-attribute");return(0,r.openBlock)(),(0,r.createElementBlock)(r.Fragment,null,[(0,r.createElementVNode)("div",o,[(0,r.createElementVNode)("div",i,[(0,r.createElementVNode)("div",a,[(0,r.createElementVNode)("div",s,[(0,r.createElementVNode)("div",l,[t[14]||(t[14]=(0,r.createElementVNode)("p",{class:"lead"},"მყიდველი",-1)),(0,r.createElementVNode)("div",c,[(0,r.createElementVNode)("div",u,[(0,r.createElementVNode)("address",null,[t[5]||(t[5]=(0,r.createElementVNode)("b",null,"სახელი :",-1)),(0,r.createTextVNode)(" "+(0,r.toDisplayString)(n.model.name)+" ",1),t[6]||(t[6]=(0,r.createElementVNode)("br",null,null,-1)),t[7]||(t[7]=(0,r.createElementVNode)("b",null,"სუბიექტის სახელი :",-1)),(0,r.createTextVNode)(" "+(0,r.toDisplayString)(n.model.subj_name)+" ",1),t[8]||(t[8]=(0,r.createElementVNode)("br",null,null,-1)),t[9]||(t[9]=(0,r.createElementVNode)("b",null,"სუბიექტის მისამართი :",-1)),(0,r.createTextVNode)(" "+(0,r.toDisplayString)(n.model.subj_address)+" ",1),t[10]||(t[10]=(0,r.createElementVNode)("br",null,null,-1))])])]),(0,r.createElementVNode)("div",d,[t[12]||(t[12]=(0,r.createElementVNode)("label",null,"კატეგრიეები",-1)),(0,r.createElementVNode)("select",{title:"აირჩიეთ",placeholder:"აირჩიეთ",class:"form-control",onChange:t[0]||(t[0]=function(){return k.category&&k.category.apply(k,arguments)})},[t[11]||(t[11]=(0,r.createElementVNode)("option",{value:"",disabled:"",selected:""}," --- აირჩიეთ --- ",-1)),((0,r.openBlock)(!0),(0,r.createElementBlock)(r.Fragment,null,(0,r.renderList)(E.main,(function(e,t){return(0,r.openBlock)(),(0,r.createElementBlock)("option",{value:k.json(e),key:t},(0,r.toDisplayString)(e.name),9,p)})),128))],32)]),t[15]||(t[15]=(0,r.createElementVNode)("label",null,"ატრიბუტები",-1)),((0,r.openBlock)(!0),(0,r.createElementBlock)(r.Fragment,null,(0,r.renderList)(E.attributes,(function(e,n){return(0,r.openBlock)(),(0,r.createElementBlock)("div",{class:"form-group",key:n,onChange:t[1]||(t[1]=function(){return k.redirect&&k.redirect.apply(k,arguments)})},[(0,r.withDirectives)((0,r.createElementVNode)("select",{title:"აირჩიეთ",placeholder:"აირჩიეთ","onUpdate:modelValue":function(t){return e.selected=t},class:"form-control",index:n},[t[13]||(t[13]=(0,r.createElementVNode)("option",{value:"",disabled:"",selected:""}," --- აირჩიეთ --- ",-1)),e?((0,r.openBlock)(!0),(0,r.createElementBlock)(r.Fragment,{key:0},(0,r.renderList)(e.res,(function(e,t){return(0,r.openBlock)(),(0,r.createElementBlock)("option",{value:k.json(e),key:t},(0,r.toDisplayString)(e.name),9,h)})),128)):(0,r.createCommentVNode)("",!0)],8,f),[[r.vModelSelect,e.selected]])],32)})),128))]),(0,r.createElementVNode)("button",{onClick:t[2]||(t[2]=function(){return k.addCategory&&k.addCategory.apply(k,arguments)}),disabled:!E.attributes.length,type:"button",class:"btn btn-sm btn-outline-success"},t[16]||(t[16]=[(0,r.createElementVNode)("i",{class:"fas fa-shield-alt"},null,-1),(0,r.createTextVNode)(" დამატება ")]),8,m)])])]),(0,r.createElementVNode)("div",b,[(0,r.createElementVNode)("div",g,[(0,r.createElementVNode)("div",v,[(0,r.createElementVNode)("button",{onClick:t[3]||(t[3]=function(){return k.exit&&k.exit.apply(k,arguments)}),type:"button",class:"btn btn-danger btn-block",style:{"margin-right":"5px"}},t[17]||(t[17]=[(0,r.createElementVNode)("i",{class:"far fa-window-close"},null,-1),(0,r.createTextVNode)(" გასვლა ")])),(0,r.createElementVNode)("button",{disabled:w.v$.$invalid,onClick:t[4]||(t[4]=function(){return k.send&&k.send.apply(k,arguments)}),type:"",class:"btn btn-success btn-block"},t[18]||(t[18]=[(0,r.createElementVNode)("i",{class:"far fa-paper-plane"},null,-1),(0,r.createTextVNode)(" გაგზავნა ")]),8,y)])])])]),(0,r.createElementVNode)("div",x,[(0,r.createElementVNode)("div",A,[((0,r.openBlock)(!0),(0,r.createElementBlock)(r.Fragment,null,(0,r.renderList)(w.m.special_attributes,(function(e,t){return(0,r.openBlock)(),(0,r.createBlock)(_,{key:e.json.id,onRemove:k.try_remove,attr:e,model:n.model},null,8,["onRemove","attr","model"])})),128))])])],64)}]])},4937:(e,t,n)=>{n.d(t,{A:()=>s});var r=n(4991),o=n.n(r),i=n(6314),a=n.n(i)()(o());a.push([e.id,".floating-input:not(:-moz-placeholder)~.floating-label{top:-1rem}.floating-input:not(:placeholder-shown)~.floating-label{top:-1rem}.floating-label{background:#fff;color:#1e4c82;font-weight:400;left:15px;padding:0 5px 5px;pointer-events:none;position:absolute;top:.3rem;transition:all .2s ease;-moz-transition:all .2s ease;-webkit-transition:all .2s ease}.floating-input{background:#fff;border:1px solid #3d85d8;border-radius:4px;box-sizing:border-box;color:#323840;display:block;padding:0 20px;&:focus{outline:none;~.floating-label{top:-1rem}}}","",{version:3,sources:["webpack://./resources/js/app/pages/Purchaser-attrs.vue"],names:[],mappings:"AA+VA,uDACI,SACJ,CAFA,wDACI,SACJ,CAEA,gBAQI,eAAgB,CAPhB,aAAc,CACd,eAAmB,CAGnB,SAAU,CAEV,iBAAsB,CAHtB,mBAAoB,CADpB,iBAAkB,CAGlB,SAAW,CAGX,uBAAyB,CACzB,4BAA8B,CAC9B,+BACJ,CAEA,gBAGI,eAAgB,CAEhB,wBAAyB,CACzB,iBAAkB,CAClB,qBAAsB,CAHtB,aAAc,CAHd,aAAc,CACd,cAAe,CAMf,QACI,YAAa,CACb,iBACI,SACJ,CACJ,CACJ",sourcesContent:['<template>\n    <div class="row">\n        <div class="col-12 col-md-12 col-lg-8 order-2 order-md-1">\n            <div class="card card-primary card-outline card-tabs">\n                <div class="card-body">\n                    <div class="tab-content" id="custom-tabs-three-tabContent">\n                        <p class="lead">მყიდველი</p>\n                        <div class="row invoice-info">\n                            <div class="col-sm-4 invoice-col">\n                                <address>\n                                    <b>სახელი :</b> {{ model.name }} <br />\n                                    <b>სუბიექტის სახელი :</b>\n                                    {{ model.subj_name }} <br />\n                                    <b>სუბიექტის მისამართი :</b>\n                                    {{ model.subj_address }} <br />\n                                </address>\n                            </div>\n                        </div>\n\n                        <div class="form-group">\n                            <label>კატეგრიეები</label>\n                            <select\n                                title="აირჩიეთ"\n                                placeholder="აირჩიეთ"\n                                class="form-control"\n                                @change="category"\n                            >\n                                <option value="" disabled selected>\n                                    --- აირჩიეთ ---\n                                </option>\n                                <option\n                                    v-for="(i, index2) in main"\n                                    :value="json(i)"\n                                    :key="index2"\n                                >\n                                    {{ i.name }}\n                                </option>\n                            </select>\n                        </div>\n\n                        <label>ატრიბუტები</label>\n                        <div\n                            class="form-group"\n                            v-for="(item, index) in attributes"\n                            :key="index"\n                            @change="redirect"\n                        >\n                            <select\n                                title="აირჩიეთ"\n                                placeholder="აირჩიეთ"\n                                v-model="item.selected"\n                                class="form-control"\n                                :index="index"\n                            >\n                                <option value="" disabled selected>\n                                    --- აირჩიეთ ---\n                                </option>\n                                <option\n                                    v-if="item"\n                                    v-for="(i, index2) in item.res"\n                                    :value="json(i)"\n                                    :key="index2"\n                                >\n                                    {{ i.name }}\n                                </option>\n                            </select>\n                        </div>\n                    </div>\n\n                    <button\n                        @click="addCategory"\n                        :disabled="!attributes.length"\n                        type="button"\n                        class="btn btn-sm btn-outline-success"\n                    >\n                        <i class="fas fa-shield-alt"></i> დამატება\n                    </button>\n                </div>\n            </div>\n        </div>\n\n        <div class="col-12 col-md-12 col-lg-4 order-1 order-md-2">\n            <div class="card card-primary card-outline card-tabs">\n                <div class="card-body">\n                    <button\n                        @click="exit"\n                        type="button"\n                        class="btn btn-danger btn-block"\n                        style="margin-right: 5px"\n                    >\n                        <i class="far fa-window-close"></i> გასვლა\n                    </button>\n\n                    <button\n                        :disabled="v$.$invalid"\n                        @click="send"\n                        type=""\n                        class="btn btn-success btn-block"\n                    >\n                        <i class="far fa-paper-plane"></i> გაგზავნა\n                    </button>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <div class="card card-primary card-outline card-tabs">\n        <div class="card-body">\n            <template\n                v-for="(attr, index) in m.special_attributes"\n                :key="attr.json.id"\n            >\n                <purchaser-single-attribute\n                    @remove="try_remove"\n                    :attr="attr"\n                    :model="model"\n                ></purchaser-single-attribute>\n            </template>\n        </div>\n    </div>\n</template>\n\n<script>\nimport Util from "Util";\nimport { reactive } from "vue";\nimport useVuelidate from "@vuelidate/core";\nimport { required, maxLength } from "@vuelidate/validators";\n\nexport default {\n    props: ["additional", "model", "url", "setting", "user", "name"],\n    data() {\n        return {\n            selected: null,\n            main: [],\n            attributes: [{ selected: "", res: [] }],\n        };\n    },\n    setup(props) {\n        return { v$: useVuelidate(), m: reactive(props.model) };\n    },\n    created() {\n        this.main = this.additional.categories;\n        // this.special_attrs = this.model.special_attributes.map(i => i.json)\n    },\n    mounted() {\n        console.log("m", this.m);\n    },\n    validations() {\n        let validateRule = {\n            m: {\n                special_attributes: {},\n            },\n        };\n        return validateRule;\n    },\n    computed: {},\n    methods: {\n        exit() {\n            return (location.href = this.setting.url.request.exit.replace(\n                "new",\n                this.model.id\n            ));\n        },\n\n        json(i) {\n            return JSON.stringify(i);\n        },\n\n        fromJson(i) {\n            return JSON.parse(i);\n        },\n\n        category() {\n            if (event.target.value) {\n                let res = this.fromJson(event.target.value);\n                this.attributes = [\n                    { selected: "", res: res.category_attributes },\n                ];\n                console.log("res", res);\n\n                // let nextIndex = Number(event.target.getAttribute(\'index\')) +1;\n                // let index = Number(event.target.getAttribute(\'index\'));\n                //  console.log(\'this.categories.length\', this.categories.length)\n                //  let result = (index > 0) ? res.nested : res.category_attributes\n                //   this.categories.splice(nextIndex, this.categories.length)\n                // if (result.length) {\n                //   this.categories[nextIndex] = { selected: \'\', res: result }\n                // }\n                // this.selected = res\n            }\n        },\n\n        redirect(event) {\n            if (event.target.value) {\n                let res = this.fromJson(event.target.value);\n                let nextIndex = Number(event.target.getAttribute("index")) + 1;\n                let index = Number(event.target.getAttribute("index"));\n                let result = index > 0 ? res.nested : res.nested;\n\n                this.attributes.splice(nextIndex, this.attributes.length);\n                if (result.length) {\n                    this.attributes[nextIndex] = { selected: "", res: result };\n                }\n\n                this.selected = res;\n            }\n        },\n\n        addCategory() {\n            try {\n                if (\n                    this.m.special_attributes.find(\n                        (i) => i.json.uuid == this.selected.uuid\n                    )\n                ) {\n                    this.$toast.error(\n                        "მყიდველი უკვე სარგებლობს მოცემული შემოთავაზებით!",\n                        { position: "top-right", duration: 7000 }\n                    );\n                } else if (!this.selected.category_type) {\n                    this.selected.isSpecial = true;\n                    this.m.special_attributes.splice(0, 0, {\n                        purchaser_id: this.model.id,\n                        category_attribute_id: this.selected.id,\n                        json: this.selected,\n                    });\n                } else {\n                    this.$toast.error("ატრიბუტი განეკუთნება კატეგორიის ტიპს!", {\n                        position: "top-right",\n                        duration: 7000,\n                    });\n                }\n            } catch (err) {\n                this.$toast.error("შეარჩიეთ ატრიბუტი!", {\n                    position: "top-right",\n                    duration: 7000,\n                });\n            }\n        },\n\n        removeRequest(id, setting, callback) {\n            if (!id) {\n                return callback();\n            }\n\n            let action = document\n                .querySelector("form#render")\n                .getAttribute("action");\n            let token = document\n                .querySelector(\'meta[name="csrf-token"\')\n                .getAttribute("content");\n\n            return this.$http\n                .delete(\n                    setting.url.request.destroy.replace("__delete__", id),\n                    { id },\n                    {\n                        "Content-Type": "application/json",\n                        "X-CSRF-TOKEN": token,\n                    }\n                )\n                .then(async (response) => {\n                    if (response.data.success == true) {\n                        callback();\n                    } else {\n                        response.data.errs.map((item) =>\n                            this.$toast.error(item, {\n                                position: "top-right",\n                                duration: 7000,\n                            })\n                        );\n                    }\n                })\n                .catch((e) => {\n                    this.$toast.error(e.response.statusText, {\n                        position: "top-right",\n                        duration: 7000,\n                    });\n                });\n        },\n\n        try_remove(model) {\n            this.removeRequest(model.id || null, this.setting, () => {\n                this.m.special_attributes.splice(\n                    this.m.special_attributes.findIndex(\n                        (i) =>\n                            i.category_attribute_id ==\n                            model.category_attribute_id\n                    ),\n                    1\n                );\n                Swal.fire("წაშლა!", "წაშლა შესრრულდა წარმატებით.", "success");\n            });\n        },\n\n        send(e) {\n            e.preventDefault();\n\n            let action = document\n                .querySelector("form#render")\n                .getAttribute("action");\n            let token = document\n                .querySelector(\'meta[name="csrf-token"\')\n                .getAttribute("content");\n\n            let res = Util.exit(\n                this.m.special_attributes.map((i) => ({\n                    ...i,\n                    json: JSON.stringify(i.json),\n                }))\n            );\n\n            this.$http\n                .post(action, res, {\n                    "Content-Type": "application/json",\n                    "X-CSRF-TOKEN": token,\n                })\n                .then(async (response) => {\n                    Util.useSwall(response).then((result) => {\n                        if (!response.data.success) {\n                            if (response.data.errs)\n                                response.data.errs.map((item) =>\n                                    this.$toast.error(item, {\n                                        position: "top-right",\n                                        duration: 7000,\n                                    })\n                                );\n                        }\n\n                        if (result.value) {\n                            window.location.replace(\n                                this.setting.url.request.exit.replace(\n                                    "new",\n                                    this.model.id\n                                )\n                            );\n                        }\n                    });\n                })\n                .catch((e) => {\n                    this.$toast.error(e.response.statusText, {\n                        position: "top-right",\n                        duration: 7000,\n                    });\n                });\n        },\n    },\n};\n<\/script>\n\n<style>\n.floating-input:not(:placeholder-shown) ~ .floating-label {\n    top: -1rem;\n}\n\n.floating-label {\n    color: #1e4c82;\n    font-weight: normal;\n    position: absolute;\n    pointer-events: none;\n    left: 15px;\n    top: 0.3rem;\n    padding: 0 5px 5px 5px;\n    background: #fff;\n    transition: 0.2s ease all;\n    -moz-transition: 0.2s ease all;\n    -webkit-transition: 0.2s ease all;\n}\n\n.floating-input {\n    display: block;\n    padding: 0 20px;\n    background: #fff;\n    color: #323840;\n    border: 1px solid #3d85d8;\n    border-radius: 4px;\n    box-sizing: border-box;\n    &:focus {\n        outline: none;\n        ~ .floating-label {\n            top: -1rem;\n        }\n    }\n}\n</style>\n'],sourceRoot:""}]);const s=a}}]);
//# sourceMappingURL=purchaser-attrs.js.map